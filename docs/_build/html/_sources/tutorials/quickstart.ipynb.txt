{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "9f1119f5",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Can not use cuDNN on context None: cannot compile with cuDNN. We got this error:\n",
      "b'/tmp/try_flags_nl_zdvdt.c:4:10: fatal error: cudnn.h: No such file or directory\\n    4 | #include <cudnn.h>\\n      |          ^~~~~~~~~\\ncompilation terminated.\\n'\n",
      "Mapped name None to device cuda: Quadro RTX 6000 (0000:3B:00.0)\n",
      "ERROR (theano.gpuarray): Could not initialize pygpu, support disabled\n",
      "Traceback (most recent call last):\n",
      "  File \"/home/harrigan/miniconda3/envs/pymc3/lib/python3.8/site-packages/theano/gpuarray/__init__.py\", line 262, in <module>\n",
      "    use(config.device)\n",
      "  File \"/home/harrigan/miniconda3/envs/pymc3/lib/python3.8/site-packages/theano/gpuarray/__init__.py\", line 251, in use\n",
      "    optdb.add_tags(\"gpuarray_opt\", \"fast_run\", \"fast_compile\")\n",
      "AttributeError: module 'theano.gpuarray.optdb' has no attribute 'add_tags'\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<Figure size 432x288 with 0 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import damuta as da"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "debe71b3",
   "metadata": {},
   "source": [
    "# Load COSMIC signatures provided in damuta"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "3517d1dc",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>A[C&gt;A]A</th>\n",
       "      <th>A[C&gt;A]C</th>\n",
       "      <th>A[C&gt;A]G</th>\n",
       "      <th>A[C&gt;A]T</th>\n",
       "      <th>C[C&gt;A]A</th>\n",
       "      <th>C[C&gt;A]C</th>\n",
       "      <th>C[C&gt;A]G</th>\n",
       "      <th>C[C&gt;A]T</th>\n",
       "      <th>G[C&gt;A]A</th>\n",
       "      <th>G[C&gt;A]C</th>\n",
       "      <th>...</th>\n",
       "      <th>C[T&gt;G]G</th>\n",
       "      <th>C[T&gt;G]T</th>\n",
       "      <th>G[T&gt;G]A</th>\n",
       "      <th>G[T&gt;G]C</th>\n",
       "      <th>G[T&gt;G]G</th>\n",
       "      <th>G[T&gt;G]T</th>\n",
       "      <th>T[T&gt;G]A</th>\n",
       "      <th>T[T&gt;G]C</th>\n",
       "      <th>T[T&gt;G]G</th>\n",
       "      <th>T[T&gt;G]T</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>SBS1</th>\n",
       "      <td>8.861572e-04</td>\n",
       "      <td>0.002280</td>\n",
       "      <td>0.000177</td>\n",
       "      <td>0.001280</td>\n",
       "      <td>0.000312</td>\n",
       "      <td>0.001790</td>\n",
       "      <td>9.321654e-05</td>\n",
       "      <td>2.230396e-16</td>\n",
       "      <td>0.001580</td>\n",
       "      <td>3.390602e-04</td>\n",
       "      <td>...</td>\n",
       "      <td>0.000128</td>\n",
       "      <td>0.000171</td>\n",
       "      <td>2.230396e-16</td>\n",
       "      <td>2.230396e-16</td>\n",
       "      <td>0.000348</td>\n",
       "      <td>1.460259e-05</td>\n",
       "      <td>2.230396e-16</td>\n",
       "      <td>0.000055</td>\n",
       "      <td>0.000583</td>\n",
       "      <td>2.230396e-16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SBS2</th>\n",
       "      <td>5.800168e-07</td>\n",
       "      <td>0.000148</td>\n",
       "      <td>0.000052</td>\n",
       "      <td>0.000098</td>\n",
       "      <td>0.000208</td>\n",
       "      <td>0.000095</td>\n",
       "      <td>2.230064e-16</td>\n",
       "      <td>4.210122e-04</td>\n",
       "      <td>0.000086</td>\n",
       "      <td>2.230064e-16</td>\n",
       "      <td>...</td>\n",
       "      <td>0.000121</td>\n",
       "      <td>0.000203</td>\n",
       "      <td>2.090060e-04</td>\n",
       "      <td>1.330038e-04</td>\n",
       "      <td>0.000037</td>\n",
       "      <td>2.230064e-16</td>\n",
       "      <td>1.670048e-05</td>\n",
       "      <td>0.000070</td>\n",
       "      <td>0.000095</td>\n",
       "      <td>2.230064e-16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SBS3</th>\n",
       "      <td>2.080832e-02</td>\n",
       "      <td>0.016507</td>\n",
       "      <td>0.001751</td>\n",
       "      <td>0.012205</td>\n",
       "      <td>0.022509</td>\n",
       "      <td>0.025310</td>\n",
       "      <td>2.511004e-03</td>\n",
       "      <td>1.540616e-02</td>\n",
       "      <td>0.007133</td>\n",
       "      <td>1.090436e-02</td>\n",
       "      <td>...</td>\n",
       "      <td>0.010704</td>\n",
       "      <td>0.007033</td>\n",
       "      <td>4.421769e-03</td>\n",
       "      <td>2.340936e-03</td>\n",
       "      <td>0.010904</td>\n",
       "      <td>5.832333e-03</td>\n",
       "      <td>7.252901e-03</td>\n",
       "      <td>0.006283</td>\n",
       "      <td>0.008053</td>\n",
       "      <td>1.050420e-02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SBS4</th>\n",
       "      <td>4.219650e-02</td>\n",
       "      <td>0.033297</td>\n",
       "      <td>0.015599</td>\n",
       "      <td>0.029498</td>\n",
       "      <td>0.080693</td>\n",
       "      <td>0.079693</td>\n",
       "      <td>2.449797e-02</td>\n",
       "      <td>6.899427e-02</td>\n",
       "      <td>0.031597</td>\n",
       "      <td>3.479711e-02</td>\n",
       "      <td>...</td>\n",
       "      <td>0.003790</td>\n",
       "      <td>0.001200</td>\n",
       "      <td>5.979504e-04</td>\n",
       "      <td>2.529790e-04</td>\n",
       "      <td>0.002430</td>\n",
       "      <td>2.519791e-04</td>\n",
       "      <td>3.769687e-04</td>\n",
       "      <td>0.000174</td>\n",
       "      <td>0.002320</td>\n",
       "      <td>5.679529e-04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SBS5</th>\n",
       "      <td>1.199760e-02</td>\n",
       "      <td>0.009438</td>\n",
       "      <td>0.001850</td>\n",
       "      <td>0.006609</td>\n",
       "      <td>0.007429</td>\n",
       "      <td>0.006139</td>\n",
       "      <td>3.459308e-03</td>\n",
       "      <td>6.488702e-03</td>\n",
       "      <td>0.010198</td>\n",
       "      <td>7.648470e-03</td>\n",
       "      <td>...</td>\n",
       "      <td>0.006129</td>\n",
       "      <td>0.007299</td>\n",
       "      <td>2.519496e-03</td>\n",
       "      <td>1.709658e-03</td>\n",
       "      <td>0.005299</td>\n",
       "      <td>2.349530e-03</td>\n",
       "      <td>5.218956e-03</td>\n",
       "      <td>0.006559</td>\n",
       "      <td>0.006939</td>\n",
       "      <td>1.349730e-02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SBS90</th>\n",
       "      <td>2.201650e-03</td>\n",
       "      <td>0.000708</td>\n",
       "      <td>0.000139</td>\n",
       "      <td>0.001755</td>\n",
       "      <td>0.001186</td>\n",
       "      <td>0.000446</td>\n",
       "      <td>2.160057e-04</td>\n",
       "      <td>1.016146e-03</td>\n",
       "      <td>0.000970</td>\n",
       "      <td>4.156959e-04</td>\n",
       "      <td>...</td>\n",
       "      <td>0.000123</td>\n",
       "      <td>0.009700</td>\n",
       "      <td>6.358611e-03</td>\n",
       "      <td>4.620121e-05</td>\n",
       "      <td>0.000231</td>\n",
       "      <td>2.880076e-03</td>\n",
       "      <td>1.858316e-02</td>\n",
       "      <td>0.000185</td>\n",
       "      <td>0.000293</td>\n",
       "      <td>8.330219e-03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SBS91</th>\n",
       "      <td>2.944550e-03</td>\n",
       "      <td>0.052997</td>\n",
       "      <td>0.000204</td>\n",
       "      <td>0.000131</td>\n",
       "      <td>0.008191</td>\n",
       "      <td>0.004580</td>\n",
       "      <td>2.326351e-03</td>\n",
       "      <td>3.239626e-03</td>\n",
       "      <td>0.003525</td>\n",
       "      <td>5.870289e-03</td>\n",
       "      <td>...</td>\n",
       "      <td>0.000429</td>\n",
       "      <td>0.000122</td>\n",
       "      <td>1.007504e-04</td>\n",
       "      <td>1.391430e-03</td>\n",
       "      <td>0.000073</td>\n",
       "      <td>5.393878e-05</td>\n",
       "      <td>5.954684e-03</td>\n",
       "      <td>0.000143</td>\n",
       "      <td>0.000628</td>\n",
       "      <td>1.008682e-03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SBS92</th>\n",
       "      <td>1.132934e-02</td>\n",
       "      <td>0.009745</td>\n",
       "      <td>0.004697</td>\n",
       "      <td>0.007758</td>\n",
       "      <td>0.018550</td>\n",
       "      <td>0.013956</td>\n",
       "      <td>5.282030e-03</td>\n",
       "      <td>1.254310e-02</td>\n",
       "      <td>0.008939</td>\n",
       "      <td>7.824920e-03</td>\n",
       "      <td>...</td>\n",
       "      <td>0.002091</td>\n",
       "      <td>0.000545</td>\n",
       "      <td>5.504900e-04</td>\n",
       "      <td>2.942300e-04</td>\n",
       "      <td>0.001544</td>\n",
       "      <td>1.996000e-04</td>\n",
       "      <td>2.208430e-03</td>\n",
       "      <td>0.000301</td>\n",
       "      <td>0.001743</td>\n",
       "      <td>1.794350e-03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SBS93</th>\n",
       "      <td>1.157323e-02</td>\n",
       "      <td>0.008096</td>\n",
       "      <td>0.001761</td>\n",
       "      <td>0.008421</td>\n",
       "      <td>0.006498</td>\n",
       "      <td>0.004796</td>\n",
       "      <td>1.508262e-03</td>\n",
       "      <td>1.006216e-02</td>\n",
       "      <td>0.002242</td>\n",
       "      <td>1.700249e-03</td>\n",
       "      <td>...</td>\n",
       "      <td>0.002552</td>\n",
       "      <td>0.038220</td>\n",
       "      <td>3.739788e-03</td>\n",
       "      <td>2.704224e-03</td>\n",
       "      <td>0.000866</td>\n",
       "      <td>6.147930e-03</td>\n",
       "      <td>5.367355e-02</td>\n",
       "      <td>0.013276</td>\n",
       "      <td>0.012705</td>\n",
       "      <td>5.495359e-02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SBS94</th>\n",
       "      <td>1.557967e-02</td>\n",
       "      <td>0.024746</td>\n",
       "      <td>0.001574</td>\n",
       "      <td>0.011076</td>\n",
       "      <td>0.079926</td>\n",
       "      <td>0.075994</td>\n",
       "      <td>6.224970e-03</td>\n",
       "      <td>3.990405e-02</td>\n",
       "      <td>0.013893</td>\n",
       "      <td>3.044996e-02</td>\n",
       "      <td>...</td>\n",
       "      <td>0.002514</td>\n",
       "      <td>0.002797</td>\n",
       "      <td>1.278935e-03</td>\n",
       "      <td>6.329348e-04</td>\n",
       "      <td>0.001974</td>\n",
       "      <td>2.121497e-03</td>\n",
       "      <td>4.071805e-03</td>\n",
       "      <td>0.001235</td>\n",
       "      <td>0.003048</td>\n",
       "      <td>3.333374e-03</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>78 rows Ã— 96 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            A[C>A]A   A[C>A]C   A[C>A]G   A[C>A]T   C[C>A]A   C[C>A]C  \\\n",
       "SBS1   8.861572e-04  0.002280  0.000177  0.001280  0.000312  0.001790   \n",
       "SBS2   5.800168e-07  0.000148  0.000052  0.000098  0.000208  0.000095   \n",
       "SBS3   2.080832e-02  0.016507  0.001751  0.012205  0.022509  0.025310   \n",
       "SBS4   4.219650e-02  0.033297  0.015599  0.029498  0.080693  0.079693   \n",
       "SBS5   1.199760e-02  0.009438  0.001850  0.006609  0.007429  0.006139   \n",
       "...             ...       ...       ...       ...       ...       ...   \n",
       "SBS90  2.201650e-03  0.000708  0.000139  0.001755  0.001186  0.000446   \n",
       "SBS91  2.944550e-03  0.052997  0.000204  0.000131  0.008191  0.004580   \n",
       "SBS92  1.132934e-02  0.009745  0.004697  0.007758  0.018550  0.013956   \n",
       "SBS93  1.157323e-02  0.008096  0.001761  0.008421  0.006498  0.004796   \n",
       "SBS94  1.557967e-02  0.024746  0.001574  0.011076  0.079926  0.075994   \n",
       "\n",
       "            C[C>A]G       C[C>A]T   G[C>A]A       G[C>A]C  ...   C[T>G]G  \\\n",
       "SBS1   9.321654e-05  2.230396e-16  0.001580  3.390602e-04  ...  0.000128   \n",
       "SBS2   2.230064e-16  4.210122e-04  0.000086  2.230064e-16  ...  0.000121   \n",
       "SBS3   2.511004e-03  1.540616e-02  0.007133  1.090436e-02  ...  0.010704   \n",
       "SBS4   2.449797e-02  6.899427e-02  0.031597  3.479711e-02  ...  0.003790   \n",
       "SBS5   3.459308e-03  6.488702e-03  0.010198  7.648470e-03  ...  0.006129   \n",
       "...             ...           ...       ...           ...  ...       ...   \n",
       "SBS90  2.160057e-04  1.016146e-03  0.000970  4.156959e-04  ...  0.000123   \n",
       "SBS91  2.326351e-03  3.239626e-03  0.003525  5.870289e-03  ...  0.000429   \n",
       "SBS92  5.282030e-03  1.254310e-02  0.008939  7.824920e-03  ...  0.002091   \n",
       "SBS93  1.508262e-03  1.006216e-02  0.002242  1.700249e-03  ...  0.002552   \n",
       "SBS94  6.224970e-03  3.990405e-02  0.013893  3.044996e-02  ...  0.002514   \n",
       "\n",
       "        C[T>G]T       G[T>G]A       G[T>G]C   G[T>G]G       G[T>G]T  \\\n",
       "SBS1   0.000171  2.230396e-16  2.230396e-16  0.000348  1.460259e-05   \n",
       "SBS2   0.000203  2.090060e-04  1.330038e-04  0.000037  2.230064e-16   \n",
       "SBS3   0.007033  4.421769e-03  2.340936e-03  0.010904  5.832333e-03   \n",
       "SBS4   0.001200  5.979504e-04  2.529790e-04  0.002430  2.519791e-04   \n",
       "SBS5   0.007299  2.519496e-03  1.709658e-03  0.005299  2.349530e-03   \n",
       "...         ...           ...           ...       ...           ...   \n",
       "SBS90  0.009700  6.358611e-03  4.620121e-05  0.000231  2.880076e-03   \n",
       "SBS91  0.000122  1.007504e-04  1.391430e-03  0.000073  5.393878e-05   \n",
       "SBS92  0.000545  5.504900e-04  2.942300e-04  0.001544  1.996000e-04   \n",
       "SBS93  0.038220  3.739788e-03  2.704224e-03  0.000866  6.147930e-03   \n",
       "SBS94  0.002797  1.278935e-03  6.329348e-04  0.001974  2.121497e-03   \n",
       "\n",
       "            T[T>G]A   T[T>G]C   T[T>G]G       T[T>G]T  \n",
       "SBS1   2.230396e-16  0.000055  0.000583  2.230396e-16  \n",
       "SBS2   1.670048e-05  0.000070  0.000095  2.230064e-16  \n",
       "SBS3   7.252901e-03  0.006283  0.008053  1.050420e-02  \n",
       "SBS4   3.769687e-04  0.000174  0.002320  5.679529e-04  \n",
       "SBS5   5.218956e-03  0.006559  0.006939  1.349730e-02  \n",
       "...             ...       ...       ...           ...  \n",
       "SBS90  1.858316e-02  0.000185  0.000293  8.330219e-03  \n",
       "SBS91  5.954684e-03  0.000143  0.000628  1.008682e-03  \n",
       "SBS92  2.208430e-03  0.000301  0.001743  1.794350e-03  \n",
       "SBS93  5.367355e-02  0.013276  0.012705  5.495359e-02  \n",
       "SBS94  4.071805e-03  0.001235  0.003048  3.333374e-03  \n",
       "\n",
       "[78 rows x 96 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "da.load_cosmic_V3()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7b95d5f6",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
